<!doctype html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="https://i.pinimg.com/1200x/97/1d/bf/971dbf5a9b4249aa231c6993774a89ab.jpg">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>#Colors</title>

  <style>
    :root{
      --fg:#e9e9ee;
      --muted:rgba(233,233,238,.62);
      --muted2:rgba(233,233,238,.40);
      --border:rgba(255,255,255,.12);
      --panel:rgba(0,0,0,.44);
      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --r:14px;

      --dockW:62px;
      --gap:10px;

      /* grid lines */
      --gridline: rgba(255,255,255,.10);
      --gridgap: 8px;

      color-scheme: dark;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      color:var(--fg);
      font: 14px/1.45 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;

      background-image: url("https://i.pinimg.com/originals/f5/93/a4/f593a4f4932080fb7b43c6ae96d1a73d.gif");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      overflow:hidden;
    }

    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(900px 520px at 15% 10%, rgba(0,0,0,.16), transparent 55%),
        radial-gradient(900px 520px at 85% 20%, rgba(0,0,0,.16), transparent 55%),
        linear-gradient(180deg, rgba(0,0,0,.58), rgba(0,0,0,.56));
      backdrop-filter: blur(0.6px);
    }

    /* Scrollbar */
    *{
      scrollbar-width: thin;
      scrollbar-color: rgba(220,220,230,.30) rgba(0,0,0,.20);
    }
    *::-webkit-scrollbar{ width:10px; height:10px; }
    *::-webkit-scrollbar-track{ background: rgba(0,0,0,.20); border-radius: 10px; }
    *::-webkit-scrollbar-thumb{
      background: rgba(220,220,230,.26);
      border: 2px solid rgba(0,0,0,.20);
      border-radius: 10px;
    }
    *::-webkit-scrollbar-thumb:hover{ background: rgba(220,220,230,.40); }

    .app{
      position:relative;
      z-index:1;
      height:100%;
      display:flex;
      flex-direction:column;
    }

    /* ===== Topbar ===== */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      background: rgba(0,0,0,.38);
      backdrop-filter: blur(3px);
      transform: translateZ(0);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .brand img{
      width:30px;height:30px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(0,0,0,.25);
      box-shadow: 0 8px 20px rgba(0,0,0,.35);
      object-fit: cover;
    }
    .brand .title{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }
    .brand .title b{
      font-weight:900;
      font-size:13px;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand .title span{
      font-size:12px;
      color:var(--muted2);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .tools{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .badge{
      font-size:12px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      color: rgba(233,233,238,.75);
      font-weight:900;
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .btn{
      cursor:pointer;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      color: rgba(233,233,238,.78);
      font-weight:900;
      transition:110ms linear;
      user-select:none;
    }
    .btn:hover{
      border-color: rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      color: rgba(233,233,238,.95);
    }
    .btn.primary{
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.16);
      color: rgba(233,233,238,.95);
    }

    .pill{
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
    }
    .label{
      font-size:12px;
      color: rgba(233,233,238,.78);
      font-weight:900;
    }

    input[type="color"]{
      width:36px;
      height:28px;
      border:1px solid rgba(255,255,255,.12);
      background: transparent;
      border-radius:10px;
      padding:0;
      cursor:pointer;
    }

    .kbd{
      font: 12px/1.2 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      color: rgba(233,233,238,.92);
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.24);
      padding: 3px 8px;
      border-radius: 10px;
      font-weight:900;
      letter-spacing:.3px;
    }

    .toggle{
      display:flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      user-select:none;
      white-space:nowrap;
      font-weight:900;
      color: rgba(233,233,238,.85);
    }
    .toggle input{
      width:16px;
      height:16px;
      accent-color: #e9e9ee;
      cursor:pointer;
    }
    .toggle span{
      font-size:12px;
      color: rgba(233,233,238,.85);
      font-weight:900;
    }

    /* ===== Layout ===== */
    .layout{
      flex:1; min-height:0;
      display:grid;
      grid-template-columns: var(--dockW) 1fr;
      overflow:hidden;
    }

    .dock{
      border-right:1px solid var(--border);
      background: rgba(0,0,0,.38);
      backdrop-filter: blur(3px);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
      padding:10px 8px;
      min-height:0;
      overflow:auto;
      transform: translateZ(0);
    }

    .dockGroup{
      width:100%;
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
      padding-bottom:10px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .dockGroup:last-child{ border-bottom:0; padding-bottom:0; }

    .icoBtn{
      width:46px;height:46px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      color: rgba(233,233,238,.78);
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      transition:110ms linear;
      position:relative;
      transform: translateZ(0);
    }
    .icoBtn:hover{
      border-color: rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      color: rgba(233,233,238,.95);
      transform: translateY(-1px) translateZ(0);
    }
    .icoBtn.active{
      border-color: rgba(255,255,255,.20);
      background: rgba(255,255,255,.10);
      color: rgba(233,233,238,.98);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .tip{
      position:absolute;
      left:58px;
      top:50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,.70);
      border:1px solid rgba(255,255,255,.14);
      border-radius:12px;
      padding:6px 10px;
      font-size:12px;
      color: rgba(233,233,238,.92);
      white-space:nowrap;
      opacity:0;
      pointer-events:none;
      transition:110ms linear;
      backdrop-filter: blur(3px);
    }
    .icoBtn:hover .tip{ opacity:1; }

    .miniLabel{
      font-size:11px;
      color: var(--muted2);
      text-align:center;
      line-height:1.2;
    }

    /* ===== MAIN: left panel only, right side shows background ===== */
    .main{
      min-height:0;
      padding:10px;
      overflow:hidden;
      display:grid;
      grid-template-columns: 420px 1fr; /* LEFT palette card + FREE background */
      gap:10px;
      align-items:start;
    }

    .paletteWrap{
      border:1px solid var(--border);
      background: var(--panel);
      backdrop-filter: blur(3px);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 420px;
      max-height: calc(100vh - 120px);
    }

    .paletteHead{
      padding:10px 10px 8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      position: sticky;
      top: 0;
      z-index: 2;
      backdrop-filter: blur(4px);
    }

    .paletteBody{
      padding:12px;
      overflow:auto;
      min-height:0;
      flex:1;
    }

    /* ===== Cubinhos ===== */
    .palette{
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr)); /* 10 cubos => 5x2 */
      gap: var(--gridgap);
    }

    .card{
      position:relative;
      aspect-ratio: 1 / 1;     /* QUADRADO */
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, filter .15s ease;
    }
    .card:hover{
      transform: translateY(-1px);
      filter: brightness(1.03);
    }

    .card::after{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(to top, rgba(0,0,0,.55), transparent 65%);
      pointer-events:none;
      opacity:.92;
    }

    .meta{
      position:absolute;
      left:8px;
      right:8px;
      bottom:8px;
      z-index:2;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }

    .hex{
      font-size:11px;
      font-weight:900;
      letter-spacing:.6px;
      text-transform:uppercase;
      padding:6px 8px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.28);
      backdrop-filter: blur(6px);
      max-width: 100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .mini{
      font-size:11px;
      font-weight:900;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.26);
      padding:6px 8px;
      border-radius:999px;
      color: rgba(233,233,238,.92);
      white-space:nowrap;
    }

    /* Right side is intentionally empty to show background */
    .bgSpace{
      min-height: 200px;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform: translateX(-50%);
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.65);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      color: rgba(233,233,238,.9);
      font-weight:900;
      font-size:12px;
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
      z-index:20;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-6px);
    }
    .toast .sw{
      width:12px;height:12px;border-radius:4px;
      border:1px solid rgba(255,255,255,.25);
    }

    @media (max-width: 980px){
      body{ overflow:auto; }
      .layout{ grid-template-columns: 1fr; }
      .dock{
        flex-direction:row;
        border-right:0;
        border-bottom:1px solid var(--border);
        padding:10px;
        gap:10px;
      }
      .dockGroup{
        flex-direction:row;
        border-bottom:0;
        padding-bottom:0;
        width:auto;
      }
      .icoBtn .tip{ display:none; }

      .main{
        grid-template-columns: 1fr; /* stack */
      }
      .paletteWrap{
        max-height: none;
      }
      .palette{
        grid-template-columns: repeat(2, minmax(0, 1fr)); /* mobile: cubos maiores */
      }
    }
  </style>
</head>

<body>
  <div class="app">

    <div class="topbar">
      <div class="brand">
        <img alt="icon" src="https://i.pinimg.com/originals/da/b4/cb/dab4cbf31e4e8d7688b0e830d5d640f1.gif">
        <div class="title">
          <b>Color Generator</b>
          <span>Pick a base color and press <span class="kbd">Space</span> to generate</span>
        </div>
      </div>

      <div class="tools">
        <div class="pill">
          <span class="label">Color</span>
          <input id="baseColor" type="color" value="#FFB7C3" aria-label="Choose base color" />
          <span id="baseHex" class="kbd">#FFB7C3</span>
        </div>

        <label class="toggle" title="Generate only light/pastel colors">
          <input id="pastelOnly" type="checkbox" />
          <span>Pastel only</span>
        </label>

        <button id="btnGenerate" class="btn primary" type="button">Generate</button>
        <button id="btnRandomBase" class="btn" type="button">Random</button>
      </div>
    </div>

    <div class="layout">
      <aside class="dock">
        <div class="dockGroup">
          <button class="icoBtn active" type="button" title="Palette">
            <span aria-hidden="true">üé®</span>
            <span class="tip">Palette</span>
          </button>

          <button class="icoBtn" type="button" title="Generate" id="dockGenerate">
            <span aria-hidden="true">‚ö°</span>
            <span class="tip">Generate</span>
          </button>
        </div>

        <div class="dockGroup">
          <div class="miniLabel">shortcuts</div>

          <button class="icoBtn" type="button" title="Space" id="dockSpace">
            <span aria-hidden="true">‚ê£</span>
            <span class="tip">Space</span>
          </button>
        </div>
      </aside>

      <main class="main">
        <!-- LEFT: cubinhos -->
        <section class="paletteWrap">
          <div class="paletteHead">
            <div class="tools">
              <span class="badge">Palette</span>
              <span class="badge" id="modeBadge">mode: normal</span>
              <span class="badge">10 colors</span>
            </div>
            <div class="tools">
              <span class="badge">click to copy</span>
            </div>
          </div>

          <div class="paletteBody">
            <main id="palette" class="palette" aria-label="Color palette"></main>
          </div>
        </section>

        <!-- RIGHT: vazio pra mostrar o background -->
        <section class="bgSpace" aria-hidden="true"></section>
      </main>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">
    <span id="toastSw" class="sw"></span>
    <span id="toastText">Copied</span>
  </div>

<script>
(() => {
  const paletteEl = document.getElementById('palette');
  const baseInput = document.getElementById('baseColor');
  const baseHexEl = document.getElementById('baseHex');
  const pastelOnlyEl = document.getElementById('pastelOnly');
  const btnGenerate = document.getElementById('btnGenerate');
  const btnRandomBase = document.getElementById('btnRandomBase');

  const toast = document.getElementById('toast');
  const toastText = document.getElementById('toastText');
  const toastSw = document.getElementById('toastSw');
  let toastTimer = null;

  const clamp = (v, min, max) => Math.min(max, Math.max(min, v));

  function hexToRgb(hex){
    const h = hex.replace('#','').trim();
    const full = h.length === 3 ? h.split('').map(c => c+c).join('') : h;
    const n = parseInt(full, 16);
    return { r: (n >> 16) & 255, g: (n >> 8) & 255, b: n & 255 };
  }

  function rgbToHex(r,g,b){
    const to = (x) => x.toString(16).padStart(2,'0');
    return ('#' + to(r) + to(g) + to(b)).toUpperCase();
  }

  function rgbToHsl(r,g,b){
    r/=255; g/=255; b/=255;
    const max = Math.max(r,g,b), min = Math.min(r,g,b);
    let h=0, s=0, l=(max+min)/2;

    const d = max - min;
    if (d !== 0){
      s = d / (1 - Math.abs(2*l - 1));
      switch(max){
        case r: h = 60 * (((g - b) / d) % 6); break;
        case g: h = 60 * (((b - r) / d) + 2); break;
        case b: h = 60 * (((r - g) / d) + 4); break;
      }
    }
    if (h < 0) h += 360;
    return { h, s: s*100, l: l*100 };
  }

  function hslToRgb(h,s,l){
    s/=100; l/=100;
    const c = (1 - Math.abs(2*l - 1)) * s;
    const x = c * (1 - Math.abs(((h/60) % 2) - 1));
    const m = l - c/2;
    let r1=0,g1=0,b1=0;

    if (0 <= h && h < 60)        { r1=c; g1=x; b1=0; }
    else if (60 <= h && h < 120) { r1=x; g1=c; b1=0; }
    else if (120 <= h && h < 180){ r1=0; g1=c; b1=x; }
    else if (180 <= h && h < 240){ r1=0; g1=x; b1=c; }
    else if (240 <= h && h < 300){ r1=x; g1=0; b1=c; }
    else                          { r1=c; g1=0; b1=x; }

    const r = Math.round((r1 + m) * 255);
    const g = Math.round((g1 + m) * 255);
    const b = Math.round((b1 + m) * 255);
    return { r, g, b };
  }

  function normalizeHex(hex){
    if (!hex) return '#000000';
    let h = hex.trim();
    if (!h.startsWith('#')) h = '#' + h;
    if (h.length === 4) h = '#' + h[1]+h[1]+h[2]+h[2]+h[3]+h[3];
    return h.slice(0,7).toUpperCase();
  }

  function rand(min,max){ return Math.random()*(max-min)+min; }

  function showToast(text, colorHex){
    toastText.textContent = text;
    toastSw.style.background = colorHex;
    toast.classList.add('show');
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => toast.classList.remove('show'), 1100);
  }

  async function copyToClipboard(text){
    try{
      await navigator.clipboard.writeText(text);
      return true;
    }catch{
      const ta = document.createElement('textarea');
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      const ok = document.execCommand('copy');
      ta.remove();
      return ok;
    }
  }

  function generateDerivedColors(baseHex, n=10, pastelOnly=false, forbiddenSet=new Set()){
    const {r,g,b} = hexToRgb(baseHex);
    const base = rgbToHsl(r,g,b);

    const results = new Set();
    const colors = [];
    let guard = 0;

    forbiddenSet.add(baseHex.toUpperCase());

    while (colors.length < n && guard < 7000){
      guard++;

      const hueJitter = pastelOnly ? rand(-8, 8) : rand(-10, 10);
      const satJitter   = pastelOnly ? rand(-10, 10) : rand(-12, 12);
      const lightJitter = pastelOnly ? rand(-8, 12)  : rand(-14, 14);

      const h = (base.h + hueJitter + 360) % 360;

      let s = clamp(base.s + satJitter, 18, 92);
      let l = clamp(base.l + lightJitter, 16, 92);

      if (pastelOnly){
        s = clamp(s, 18, 45);
        l = clamp(l, 72, 92);
      } else {
        s = clamp(s, 22, 62);
        l = clamp(l, 28, 82);
      }

      const rgb = hslToRgb(h,s,l);
      const hex = rgbToHex(rgb.r, rgb.g, rgb.b);

      if (!results.has(hex) && !forbiddenSet.has(hex)){
        results.add(hex);
        colors.push(hex);
      }
    }

    while (colors.length < n){
      const shift = (base.h + 20 * (colors.length + 1)) % 360;
      const s = pastelOnly ? 32 : 48;
      const l = pastelOnly ? 84 : 62;
      const rgb = hslToRgb(shift, s, l);
      const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
      if (!results.has(hex) && !forbiddenSet.has(hex)){
        results.add(hex);
        colors.push(hex);
      }
    }

    return colors;
  }

  function renderPalette(colors){
    paletteEl.innerHTML = '';
    colors.forEach((hex) => {
      const card = document.createElement('section');
      card.className = 'card';
      card.style.background = hex;
      card.setAttribute('data-hex', hex);
      card.setAttribute('aria-label', `Color ${hex}. Click to copy.`);

      const meta = document.createElement('div');
      meta.className = 'meta';

      const hexEl = document.createElement('div');
      hexEl.className = 'hex';
      hexEl.textContent = hex;

      const mini = document.createElement('div');
      mini.className = 'mini';
      mini.textContent = 'Copy';

      meta.appendChild(hexEl);
      meta.appendChild(mini);
      card.appendChild(meta);

      card.addEventListener('click', async () => {
        const ok = await copyToClipboard(hex);
        showToast(ok ? `Copied: ${hex}` : `Couldn‚Äôt copy üòÖ`, hex);
      });

      paletteEl.appendChild(card);
    });
  }

  function setBase(hex){
    const h = normalizeHex(hex);
    baseInput.value = h;
    baseHexEl.textContent = h;
    localStorage.setItem('baseColor', h);
  }

  function palettesEqual(a,b){
    if (!Array.isArray(a) || !Array.isArray(b)) return false;
    if (a.length !== b.length) return false;
    for (let i=0;i<a.length;i++){
      if (normalizeHex(a[i]) !== normalizeHex(b[i])) return false;
    }
    return true;
  }

  function updateModeBadge(){
    const badge = document.getElementById('modeBadge');
    if(badge) badge.textContent = `mode: ${pastelOnlyEl.checked ? 'pastel' : 'normal'}`;
  }

  function generate(){
    const baseHex = normalizeHex(baseInput.value);
    setBase(baseHex);

    const pastelOnly = !!pastelOnlyEl.checked;
    updateModeBadge();

    let prev = null;
    try{
      prev = JSON.parse(localStorage.getItem('lastPalette') || 'null');
      if (!Array.isArray(prev) || prev.length !== 10) prev = null;  // <-- agora 10
    }catch{ prev = null; }

    const forbidden = new Set();
    if (prev) prev.forEach(c => forbidden.add(normalizeHex(c)));

    let colors = null;

    for (let attempt=0; attempt<12; attempt++){
      const candidate = generateDerivedColors(baseHex, 10, pastelOnly, new Set(forbidden));

      if (!prev || !palettesEqual(candidate, prev)){
        colors = candidate;
        break;
      }
      candidate.forEach(c => forbidden.add(normalizeHex(c)));
    }

    if (!colors){
      colors = generateDerivedColors(baseHex, 10, pastelOnly, new Set(forbidden));
    }

    renderPalette(colors);
    localStorage.setItem('lastPalette', JSON.stringify(colors));
    localStorage.setItem('pastelOnly', pastelOnly ? '1' : '0');
  }

  function randomBase(){
    const h = rand(0, 360);
    const s = rand(35, 70);
    const l = rand(40, 70);
    const {r,g,b} = hslToRgb(h,s,l);
    setBase(rgbToHex(r,g,b));
    generate();
  }

  baseInput.addEventListener('input', () => {
    baseHexEl.textContent = normalizeHex(baseInput.value);
  });

  baseInput.addEventListener('change', generate);
  pastelOnlyEl.addEventListener('change', generate);
  btnGenerate.addEventListener('click', generate);
  btnRandomBase.addEventListener('click', randomBase);

  const dockGen = document.getElementById('dockGenerate');
  const dockSpace = document.getElementById('dockSpace');
  if(dockGen) dockGen.addEventListener('click', generate);
  if(dockSpace) dockSpace.addEventListener('click', generate);

  window.addEventListener('keydown', (e) => {
    const tag = (document.activeElement?.tagName || '').toLowerCase();
    const isTyping = tag === 'input' || tag === 'textarea' || document.activeElement?.isContentEditable;

    if (!isTyping && (e.code === 'Space' || e.key === ' ')){
      e.preventDefault();
      generate();
    }
  }, { passive:false });

  const savedBase = localStorage.getItem('baseColor');
  const savedPastel = localStorage.getItem('pastelOnly');

  if (savedPastel != null) pastelOnlyEl.checked = savedPastel === '1';
  if (savedBase) setBase(savedBase);
  else setBase(baseInput.value);

  updateModeBadge();
  generate();
})();
</script>
</body>
</html>
